---
import Layout from '~/layouts/PageLayout.astro';
import StreamingLinksHub from '~/components/media/StreamingLinksHub.astro';
import { youtubePerformances, spotifyAlbums } from '~/data/media/youtube-performances.js';

const metadata = {
  title: 'Media with Spotify | Bree Lowdermilk',
  description: 'Celebrity performances and recordings with Spotify integration',
  openGraph: {
    title: 'Media | Bree Lowdermilk',
    description: 'Listen to Kerrigan-Lowdermilk songs on Spotify and other platforms',
    type: 'website'
  }
};

// Map performances to include Spotify links where available
// These would need to be actual Spotify track IDs
const featuredTracks = [
  {
    id: 'run-away-mad-ones',
    title: 'Run Away With Me',
    artist: 'The Mad Ones (Studio Cast Recording)',
    category: 'official',
    youtubeId: '61EL69OZSlY',
    streamingLinks: {
      spotify: 'https://open.spotify.com/track/5n8Aro6j1bEGIy7Tpo7FV7',
      apple: 'https://music.apple.com/us/album/run-away-with-me/1512606875?i=1512607098',
      youtube: 'https://www.youtube.com/watch?v=61EL69OZSlY'
    },
    notes: 'From the 2020 Studio Cast Recording'
  },
  {
    id: 'freedom-mad-ones',
    title: 'Freedom',
    artist: 'The Mad Ones (Studio Cast Recording)',
    category: 'official',
    youtubeId: 'MNKpuVxVxng',
    streamingLinks: {
      spotify: 'https://open.spotify.com/track/0VgkVdmE4gld66l8iyGjgx',
      apple: 'https://music.apple.com/us/album/freedom/1512606875?i=1512607111',
      youtube: 'https://www.youtube.com/watch?v=MNKpuVxVxng'
    },
    notes: 'From the 2020 Studio Cast Recording'
  },
  {
    id: 'say-the-word-ofm',
    title: 'Say the Word',
    artist: 'Kerrigan-Lowdermilk',
    category: 'official',
    youtubeId: '6LhEZccYPy4',
    streamingLinks: {
      spotify: 'https://open.spotify.com/track/3Kkjo3cT83cw09VJyrLNwZ',
      apple: 'https://music.apple.com/us/album/say-the-word/489679915?i=489679930',
      youtube: 'https://www.youtube.com/watch?v=6LhEZccYPy4'
    },
    notes: 'From "Our First Mistake" album (2011)'
  },
  {
    id: 'when-it-happens-to-you',
    title: 'When It Happens to You',
    artist: 'Kerrigan-Lowdermilk',
    category: 'official',
    youtubeId: null,
    streamingLinks: {
      spotify: 'https://open.spotify.com/track/3eGKL2Lh6SWjBScP2HLUNa',
      apple: 'https://music.apple.com/us/album/when-it-happens-to-you/489679915?i=489679919'
    },
    notes: 'From "Our First Mistake" album (2011)'
  },
  {
    id: 'holding-on-live',
    title: 'Holding On',
    artist: 'Kerrigan-Lowdermilk Live',
    category: 'live',
    youtubeId: 'KcDMrmilTdE',
    streamingLinks: {
      spotify: 'https://open.spotify.com/track/6xJ7V8tkoJNgzY8YtWFPD9',
      apple: 'https://music.apple.com/us/album/holding-on/664589606?i=664589733',
      youtube: 'https://www.youtube.com/watch?v=KcDMrmilTdE'
    },
    notes: 'Live recording featuring Keala Settle'
  },
  {
    id: 'one-last-prayer',
    title: 'One Last Prayer',
    artist: 'Kerrigan-Lowdermilk',
    category: 'official',
    youtubeId: null,
    streamingLinks: {
      spotify: 'https://open.spotify.com/track/2mQJQNPCmV5HhGnRrIJvNO',
      apple: 'https://music.apple.com/us/album/one-last-prayer/489679915?i=489679939'
    },
    notes: 'From "Our First Mistake" album (2011)'
  }
];

// Celebrity performances section data
const celebrityPerformances = youtubePerformances
  .filter(p => p.priority === 1)
  .slice(0, 12)
  .map(p => ({
    ...p,
    imageUrl: `/src/assets/images/media/${p.performer?.toLowerCase().replace(/\s+/g, '-')}.jpg`
  }));
---

<Layout metadata={metadata}>
  <section class="px-4 py-16 mx-auto max-w-6xl lg:px-8 lg:py-20">
    <h1 class="text-5xl font-bold mb-8 text-center">Media</h1>
    
    <!-- Spotify Integration Section -->
    <div class="mb-16">
      <h2 class="text-3xl font-bold mb-6">Stream Our Music</h2>
      <p class="text-gray-600 dark:text-gray-300 mb-8">Listen to Kerrigan-Lowdermilk songs on your favorite streaming platforms</p>
      
      <!-- Using the StreamingLinksHub component -->
      <StreamingLinksHub items={featuredTracks} />
    </div>

    <!-- Spotify Album Players -->
    <div class="mb-16">
      <h2 class="text-3xl font-bold mb-6">Full Albums on Spotify</h2>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        {spotifyAlbums.map((album) => (
          <div class="bg-gray-50 dark:bg-gray-800 p-4 rounded-lg">
            <h3 class="font-bold mb-3">{album.title}</h3>
            <iframe
              src={`https://open.spotify.com/embed/album/${album.spotifyId}?utm_source=generator&theme=0`}
              width="100%"
              height="352"
              frameBorder="0"
              allowfullscreen=""
              allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
              loading="lazy"
              class="rounded-lg"
            ></iframe>
            <div class="mt-3">
              <a
                href={album.spotifyUrl}
                target="_blank"
                rel="noopener noreferrer"
                class="inline-flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-full transition-colors text-sm"
              >
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.419 1.56-.299.421-1.02.599-1.559.3z"/>
                </svg>
                Open in Spotify
              </a>
            </div>
          </div>
        ))}
      </div>
    </div>

    <!-- Celebrity Performances with Spotify Links -->
    <div class="mb-16">
      <h2 class="text-3xl font-bold mb-6">Celebrity Performances</h2>
      <p class="text-gray-600 dark:text-gray-300 mb-8">Watch Broadway stars perform our songs</p>
      
      <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4">
        {celebrityPerformances.map((performance) => (
          <div class="group relative bg-white dark:bg-gray-800 rounded-lg overflow-hidden shadow-md hover:shadow-xl transition-all duration-300">
            <div class="aspect-square bg-gray-200">
              <img 
                src={performance.imageUrl}
                alt={`${performance.performer} - ${performance.title}`}
                class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
                loading="lazy"
                onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 400 400%22%3E%3Crect fill=%22%23e5e7eb%22 width=%22400%22 height=%22400%22/%3E%3Ctext x=%22200%22 y=%22200%22 font-family=%22sans-serif%22 font-size=%2218%22 fill=%22%239ca3af%22 text-anchor=%22middle%22%3E' + this.alt + '%3C/text%3E%3C/svg%3E'"
              />
            </div>
            <div class="p-3">
              <h3 class="font-bold text-sm mb-1 line-clamp-1">{performance.title}</h3>
              <p class="text-xs text-gray-600 dark:text-gray-400 mb-3 line-clamp-1">{performance.performer}</p>
              
              <div class="flex gap-2">
                {performance.youtubeId && (
                  <a
                    href={`https://www.youtube.com/watch?v=${performance.youtubeId}`}
                    target="_blank"
                    rel="noopener noreferrer"
                    class="flex-1 text-center py-1.5 bg-red-500 hover:bg-red-600 text-white rounded text-xs transition-colors"
                  >
                    YouTube
                  </a>
                )}
                <button
                  class="flex-1 text-center py-1.5 bg-gray-300 text-gray-500 rounded text-xs cursor-not-allowed"
                  disabled
                  title="Spotify link coming soon"
                >
                  Spotify
                </button>
              </div>
            </div>
          </div>
        ))}
      </div>
    </div>

    <!-- Individual Track Players -->
    <div class="mb-16">
      <h2 class="text-3xl font-bold mb-6">Featured Tracks</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        {featuredTracks.slice(0, 4).map((track) => (
          <div class="bg-gray-50 dark:bg-gray-800 p-4 rounded-lg">
            <h3 class="font-semibold mb-2">{track.title}</h3>
            <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">{track.artist}</p>
            {track.streamingLinks?.spotify && (
              <iframe
                src={`https://open.spotify.com/embed/track/${track.streamingLinks.spotify.split('/').pop()}?utm_source=generator&theme=0`}
                width="100%"
                height="80"
                frameBorder="0"
                allowfullscreen=""
                allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
                loading="lazy"
                class="rounded"
              ></iframe>
            )}
          </div>
        ))}
      </div>
    </div>

  </section>
</Layout>

<style>
  .line-clamp-1 {
    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>